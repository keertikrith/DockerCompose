<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Space Defender</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body, html {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #000; /* Black background for space */
            font-family: Arial, sans-serif;
            color: white;
        }
        #gameCanvas {
            display: block;
            background: url('https://i.imgur.com/8I8FZ1E.jpg') repeat; /* Starry background */
            background-size: cover;
        }
        #scoreBoard {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            text-shadow: 2px 2px 4px #000;
        }
        #gameOver {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            display: none;
            text-align: center;
            text-shadow: 2px 2px 8px #ff0000;
        }
        #restartBtn {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 24px;
            background: #ff0000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: none;
            color: #fff;
            box-shadow: 2px 2px 4px #000;
        }
        #restartBtn:hover {
            background: #cc0000;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div id="scoreBoard">Score: 0</div>
    <div id="gameOver">
        <div>GAME OVER</div>
        <button id="restartBtn">Restart</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreBoard = document.getElementById('scoreBoard');
        const gameOverScreen = document.getElementById('gameOver');
        const restartBtn = document.getElementById('restartBtn');

        // Set canvas dimensions
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // Handle window resize
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // Game Variables
        let score = 0;
        let gameOver = false;
        const playerWidth = 60;
        const playerHeight = 60;
        const playerSpeed = 7;
        const laserWidth = 4;
        const laserHeight = 20;
        const laserSpeed = 10;
        const enemyWidth = 50;
        const enemyHeight = 50;
        const enemySpeed = 3;
        const enemySpawnInterval = 2000; // in ms

        // Key Controls
        const keys = {
            ArrowLeft: false,
            ArrowRight: false,
            Space: false
        };

        // Event Listeners for Key Presses
        window.addEventListener('keydown', (e) => {
            if (e.code in keys) {
                keys[e.code] = true;
                e.preventDefault();
            }
        });
        window.addEventListener('keyup', (e) => {
            if (e.code in keys) {
                keys[e.code] = false;
                e.preventDefault();
            }
        });

        // Player Object
        const player = {
            x: canvas.width / 2 - playerWidth / 2,
            y: canvas.height - playerHeight - 20,
            width: playerWidth,
            height: playerHeight,
            color: '#00ff00',
            draw: function() {
                ctx.fillStyle = this.color;
                // Draw spaceship as a triangle
                ctx.beginPath();
                ctx.moveTo(this.x + this.width / 2, this.y);
                ctx.lineTo(this.x, this.y + this.height);
                ctx.lineTo(this.x + this.width, this.y + this.height);
                ctx.closePath();
                ctx.fill();
            },
            move: function() {
                if (keys['ArrowLeft'] && this.x > 0) {
                    this.x -= playerSpeed;
                }
                if (keys['ArrowRight'] && this.x + this.width < canvas.width) {
                    this.x += playerSpeed;
                }
            }
        };

        // Laser Array
        const lasers = [];

        // Laser Object
        class Laser {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.width = laserWidth;
                this.height = laserHeight;
                this.color = '#ff0000';
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.y, this.width, this.height);
            }

            update() {
                this.y -= laserSpeed;
                this.draw();
            }
        }

        // Enemy Array
        const enemies = [];

        // Enemy Object
        class Enemy {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.width = enemyWidth;
                this.height = enemyHeight;
                this.color = '#0000ff';
            }

            draw() {
                ctx.fillStyle = this.color;
                // Draw enemy as a rectangle with eyes
                ctx.fillRect(this.x, this.y, this.width, this.height);
                // Eyes
                ctx.fillStyle = '#ffffff';
                ctx.beginPath();
                ctx.arc(this.x + this.width * 0.25, this.y + this.height * 0.3, 5, 0, Math.PI * 2);
                ctx.arc(this.x + this.width * 0.75, this.y + this.height * 0.3, 5, 0, Math.PI * 2);
                ctx.fill();
            }

            update() {
                this.y += enemySpeed;
                this.draw();
            }
        }

        // Spawn Enemies at Intervals
        function spawnEnemies() {
            if (gameOver) return;
            const x = Math.random() * (canvas.width - enemyWidth);
            const y = -enemyHeight;
            enemies.push(new Enemy(x, y));
            setTimeout(spawnEnemies, enemySpawnInterval);
        }

        // Collision Detection
        function isColliding(obj1, obj2) {
            return (
                obj1.x < obj2.x + obj2.width &&
                obj1.x + obj1.width > obj2.x &&
                obj1.y < obj2.y + obj2.height &&
                obj1.y + obj1.height > obj2.y
            );
        }

        // Game Over Function
        function endGame() {
            gameOver = true;
            gameOverScreen.style.display = 'block';
            restartBtn.style.display = 'block';
        }

        // Restart Game Function
        restartBtn.addEventListener('click', () => {
            // Reset Game Variables
            score = 0;
            gameOver = false;
            enemies.length = 0;
            lasers.length = 0;
            scoreBoard.textContent = 'Score: 0';
            gameOverScreen.style.display = 'none';
            // Reset Player Position
            player.x = canvas.width / 2 - playerWidth / 2;
            // Start Spawning Enemies
            spawnEnemies();
            // Start Animation
            requestAnimationFrame(gameLoop);
        });

        // Main Game Loop
        function gameLoop() {
            if (gameOver) return;

            // Clear Canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Move and Draw Player
            player.move();
            player.draw();

            // Handle Lasers
            for (let i = 0; i < lasers.length; i++) {
                lasers[i].update();
                // Remove lasers that go off-screen
                if (lasers[i].y + lasers[i].height < 0) {
                    lasers.splice(i, 1);
                    i--;
                }
            }

            // Handle Enemies
            for (let i = 0; i < enemies.length; i++) {
                enemies[i].update();
                // Check if enemy reaches bottom
                if (enemies[i].y + enemies[i].height > canvas.height) {
                    endGame();
                }
                // Check collision with player
                if (isColliding(enemies[i], player)) {
                    endGame();
                }
                // Check collision with lasers
                for (let j = 0; j < lasers.length; j++) {
                    if (isColliding(enemies[i], lasers[j])) {
                        // Remove enemy and laser
                        enemies.splice(i, 1);
                        lasers.splice(j, 1);
                        // Increment score
                        score += 10;
                        scoreBoard.textContent = 'Score: ' + score;
                        break;
                    }
                }
            }

            // Request Next Frame
            requestAnimationFrame(gameLoop);
        }

        // Handle Shooting
        window.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && !gameOver) {
                // Shoot a laser from the center top of the player
                const laserX = player.x + player.width / 2 - laserWidth / 2;
                const laserY = player.y;
                lasers.push(new Laser(laserX, laserY));
            }
        });

        // Start the Game
        spawnEnemies();
        requestAnimationFrame(gameLoop);
    </script>
</body>
</html>
